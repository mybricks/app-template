!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react"),require("react-dom")):"function"==typeof define&&define.amd?define(["react","react-dom"],t):"object"==typeof exports?exports.rxui=t(require("react"),require("react-dom")):e.rxui=t(e.React,e.ReactDOM)}(window,(function(__WEBPACK_EXTERNAL_MODULE__1__,__WEBPACK_EXTERNAL_MODULE__4__){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=10)}([function(e,t,n){"use strict";n.d(t,"f",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return c})),n.d(t,"e",(function(){return f})),n.d(t,"d",(function(){return u})),n.d(t,"g",(function(){return s}));const r="_rxui_meta_",o="_hc_",i="_hc_from_",c="_ignore_",f="_ignore_observable_",u="_ignore_me_",s="function"==typeof HTMLElement?HTMLElement:function(){};"function"==typeof SVGElement&&SVGElement},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE__1__},function(e,t,n){"use strict";(function(e){n.d(t,"f",(function(){return i})),n.d(t,"d",(function(){return c})),n.d(t,"g",(function(){return f})),n.d(t,"j",(function(){return u})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return a})),n.d(t,"e",(function(){return l})),n.d(t,"h",(function(){return p})),n.d(t,"a",(function(){return d})),n.d(t,"i",(function(){return h}));var r=n(7),o=n(0);function i(e,t){const n=e[o.c];return!!n&&n[t]}function c(e){return e[o.a]||e[o.b]}function f(e){if("function"==typeof HTMLElement)return e instanceof HTMLElement;e&&"object"==typeof e&&(1===e.nodeType||9===e.nodeType)&&e.nodeName}function u(e="u_",t=5){return e+Object(r.a)(t)}function s(e,t){let n;if("string"==typeof t){let e=t.lastIndexOf(".");n=-1!==e?t.substring(e+1):t}else n=e.name;return n.replace(/[^\w]/gi,"_")}function a(e,t){let n=[];do{if(e==Object.prototype||e==Function.prototype)break;try{n=n.concat(Object.getOwnPropertyNames(e))}catch(e){console.error(e)}}while(e=Object.getPrototypeOf(e));return n.filter(n=>{if(!t||t&&"function"!=typeof e[n])return"constructor"!=n&&!/^__.+/g.test(n)})}function l(e,t){let n=Object.getOwnPropertyDescriptor(e,t);if(void 0===n){let r=e;for(;void 0===n&&null!=(r=Object.getPrototypeOf(r))&&r!==Object.prototype;)n=Object.getOwnPropertyDescriptor(r,t)}return n}function p(e){return"symbol"==typeof e||function(e){return"object"==typeof e&&null!==e}(e)&&"[object Symbol]"===Object.prototype.toString.call(e)}function d(){let e,t=[];return{push(n,...r){t.find(e=>e.task===n)||t.push({task:n,args:r}),e||(e=1,Promise.resolve().then(()=>{e=void 0,t.forEach(({task:e,args:n},r)=>{e(...n),t[r]=void 0}),t=t.filter(e=>e)}))}}}const _={};function h(t,n){const r="object"==typeof window?window:"object"==typeof e?e:_;let o;if(r){let e=r.__rxui__;void 0===e&&(e=r.__rxui__={}),o=e[t]?e[t]:e[t]=n}else o=n;return o}}).call(this,n(9))},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"c",(function(){return SerializedReg})),__webpack_require__.d(__webpack_exports__,"a",(function(){return Ignore})),__webpack_require__.d(__webpack_exports__,"b",(function(){return Serializable})),__webpack_require__.d(__webpack_exports__,"d",(function(){return searchForMeta}));var _util__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2),_constants__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(0);const SerializedReg=Object(_util__WEBPACK_IMPORTED_MODULE_0__.i)("_rxui_serializedReg_",{});function Ignore(e,t){let n=Object.getOwnPropertyDescriptor(e,_constants__WEBPACK_IMPORTED_MODULE_1__.c);if(n)n.value[t]=!0;else{let n,r=Object.getPrototypeOf(e);for(;r&&r!==Object.prototype&&(n=Object.getOwnPropertyDescriptor(r,_constants__WEBPACK_IMPORTED_MODULE_1__.c),!n);)r=Object.getPrototypeOf(r);const o=Object.assign({},n&&n.value);Object.defineProperty(e,_constants__WEBPACK_IMPORTED_MODULE_1__.c,{value:o,writable:!0}),o[t]=!0}}function Serializable(e){if(1==arguments.length){const e=arguments[0];if("function"==typeof e)return hashcodeFn(e);if("string"==typeof e)return function(t){return hashcodeFn(t,e)};if("object"==typeof e&&"string"==typeof e.name){let{name:t,load:n}=e;return function(e){return hashcodeFn(e,t,n)}}throw new Error("@Serializable's param error.")}throw new Error("@Serializable should be used to decorate class only.")}function searchForMeta(e){let t;const n=e.constructor&&e.constructor[_constants__WEBPACK_IMPORTED_MODULE_1__.f],r=Object.getPrototypeOf(e),o=r&&searchForMeta(r);return o?(t=Object.assign({},n||{}),Object.keys(o).forEach(e=>{t[e]=n&&n[e]?Object.assign({},o[e],n[e]):Object.assign({},o[e])}),t):n}function hashcodeFn(fn,name,load){if("string"==typeof name&&SerializedReg[name])throw new Error(name+" had been registered.");let fnName=name?Object(_util__WEBPACK_IMPORTED_MODULE_0__.b)(fn,name):fn.name;const getUid=_util__WEBPACK_IMPORTED_MODULE_0__.j;let proxyFn=null,proto;return eval(`\n    proxyFn = function ${fnName}() {//Proxied and named\n      try {\n        const _this = new fn(...arguments)\n\n        Object.defineProperty(_this, '${_constants__WEBPACK_IMPORTED_MODULE_1__.a}', {\n          value: getUid('${fnName}_'),\n          writable: true,\n          enumerable: false\n        })\n\n        Object.setPrototypeOf(_this, proto)\n        return _this\n      } catch (ex) {//not support ES6?\n        throw ex\n\n        // var args = []\n        //\n        // for(var i=0;i<arguments.length;i++){\n        //   args.push(arguments[i])\n        // }\n        // fn.apply(this,args)\n        //\n          // Object.defineProperty(this, '${_constants__WEBPACK_IMPORTED_MODULE_1__.a}', {\n          //     value:getUid('${fnName}_'),\n        //     writable: true,\n        //     enumerable:false\n        // })\n      }\n    }\n    proto = {\n      constructor: proxyFn\n    }\n    var statics = Object.getOwnPropertyNames(fn)\n    var regc = /^(length|name|prototype)$/gi\n    for (var i = 0; i < statics.length; i++) {\n      var nm = statics[i]\n      if (!nm.match(regc)) {\n        proxyFn[nm] = fn[nm]\n      }\n    }\n    Object.setPrototypeOf(proto, fn.prototype)\n    proxyFn.prototype = proto\n  `),"string"==typeof name&&(SerializedReg[name]={proto:proxyFn,load:load},setMeta(proxyFn,"serialized","name",name)),proxyFn}function setMeta(e,t,n,r){const o=0==Object.getOwnPropertyNames(e).filter(e=>e==_constants__WEBPACK_IMPORTED_MODULE_1__.f).length?e[_constants__WEBPACK_IMPORTED_MODULE_1__.f]={}:e[_constants__WEBPACK_IMPORTED_MODULE_1__.f];(o[t]||(o[t]={}))[n]=r||e[n]}},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE__4__},function(e){e.exports=JSON.parse('{"name":"@mybricks/rxui","version":"1.0.86","description":"Responsive framework for React programingï¼Œlike the Mobx but not only Mobx","main":"index.js","types":"./types.d.ts","scripts":{"test":"jest --config ./tests/jest.config.js --rootDir . --watch","test-dev":"jest --config ./tests/jest.config.js --rootDir . --watch","build":"webpack --config ./scripts/webpack.build.js","build-test":"jest-webpack --config ./tests/jest.config.js --rootDir .","prepublish":" "},"keywords":["RXUI"],"author":"CheMingjun","license":"MIT","dependencies":{"nanoid":"4.0.0"},"devDependencies":{"react":"^18.2.0","react-dom":"^18.2.0","reflect-metadata":"^0.1.13","@babel/core":"^7.8.7","@babel/plugin-proposal-class-properties":"^7.8.3","@babel/preset-env":"^7.8.7","@babel/preset-react":"^7.8.3","@testing-library/react":"^11.2.5","@types/node":"^13.9.0","@types/react":"^18.0.21","@types/react-dom":"^18.0.6","babel-loader":"^8.0.6","core-js":"^2.6.11","jest":"^26.6.3","rimraf":"^2.6.2","ts-loader":"^6.2.1","typescript":"^3.8.3","webpack":"^4.42.0","webpack-bundle-analyzer":"^3.6.1","webpack-cli":"^3.3.11"},"repository":{"type":"git","url":"https://github.com/mybricks/rxui.git"},"publishConfig":{"registry":"https://registry.npmjs.org"}}')},function(e,t,n){"use strict";var r=n(4);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));let r=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((e,t)=>e+=(t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_","")},,function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";n.r(t),n.d(t,"stopWatch",(function(){return ze})),n.d(t,"keepWatch",(function(){return Ve})),n.d(t,"stopUpdate",(function(){return Xe})),n.d(t,"render",(function(){return g})),n.d(t,"createRoot",(function(){return b})),n.d(t,"useObservable",(function(){return de})),n.d(t,"useComputed",(function(){return ye})),n.d(t,"useWatcher",(function(){return be})),n.d(t,"useOnce",(function(){return me})),n.d(t,"observe",(function(){return ve})),n.d(t,"observable",(function(){return ue})),n.d(t,"implement",(function(){return Oe})),n.d(t,"from",(function(){return Te})),n.d(t,"fork",(function(){return Pe})),n.d(t,"IgnoreObservable",(function(){return De})),n.d(t,"undo",(function(){return Re})),n.d(t,"redo",(function(){return Ce})),n.d(t,"takeSnap",(function(){return Ue})),n.d(t,"snap",(function(){return ee})),n.d(t,"Serializable",(function(){return W.b})),n.d(t,"Ignore",(function(){return W.a})),n.d(t,"dump",(function(){return X})),n.d(t,"load",(function(){return F})),n.d(t,"deserialize",(function(){return B})),n.d(t,"recycle",(function(){return H})),n.d(t,"clone",(function(){return G})),n.d(t,"ignore",(function(){return Q})),n.d(t,"dragable",(function(){return $e})),n.d(t,"getPositionInKonva",(function(){return Be})),n.d(t,"getPosition",(function(){return Fe})),n.d(t,"evt",(function(){return Ke})),n.d(t,"uuid",(function(){return s.j}));var r=n(5),o=n(1),i=n.n(o),c=n(4),f=n(6);const u=["onContextMenu","onClick","onDoubleClick","onMouseDown","onMouseUp","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onDrop","onDrag","onDragStart","onDragEnd","onDragEnter","onDragLeave","onDragOver","onDragExit","onTouchStart","onTouchEnd","onTouchMove","onTouchCancel","onKeyPress","onKeyDown","onKeyUp","onCopy","onCut","onPaste","onChange","onInput","onSubmit","onFocus","onBlur","onScroll"];var s=n(2);const{ReactCurrentDispatcher:a,ReactCurrentOwner:l}=i.a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,p=Object(s.i)("CurrentNodeInfo",{});let d,_;const h=i.a.createContext(!1),y=function(...e){return m(c.render,...e)};y.test=function(e,t){return m(c.render,t)};var g=y;const b=function(...e){const t=Object(f.createRoot)(...e);return{unmount:(...e)=>t.unmount.call(t,...e),render:(...e)=>m(t,...e)}};function m(e,...t){if(d||(d=i.a.createElement,i.a.createElement=_=function(...e){if(!p.current&&!h.Consumer._currentValue)return d(...e);let t;if(e.length>0&&"function"==typeof(t=e[0])){if(!t.prototype||!(t.prototype instanceof i.a.Component)&&void 0===t.prototype.isReactComponent){const n=v(t);e.splice(0,1,n);const r=e[1]||{};try{Object.defineProperty(r,"_parent_info_",{value:i.a.createElement._cur_parent_info_,writable:!1,enumerable:!0,configurable:!1})}catch(e){console.info(`Object.defineProperty 'PARENT_NODE_INFO' error,in object ${r}.`)}e.splice(1,1,r)}return d(...e)}if("string"==typeof e[0]){const t=e[1];if(t){const e=i.a.createElement._render_in_node_info_;if(e){const n=e.id;u.forEach(e=>{let r=t[e];"function"==typeof r&&(t[e]=function(...e){let t;return S.curRT.setNodeInfoId(n),Object(c.unstable_batchedUpdates)(()=>{try{t=r(...e)}finally{}}),S.curRT.clear(),t})})}}}return d(...e)}),t.length>0){let e=t[0];if(e){if("function"==typeof e){i.a.createElement=d;try{e=e()}catch(e){throw e}finally{i.a.createElement=_}}const n=e.type,r=e.props;if(n){const o=v(n),c=e.key?{key:e.key,ref:e.ref}:{ref:e.ref},f=i.a.createElement(h.Provider,{value:!0},i.a.createElement(o,Object.assign(c,r)));t.splice(0,1,f)}}}if("function"==typeof e){return e.call(void 0,...t)}if("object"==typeof e){return e.render.call(e,...t)}}function v(e){let t=!1,n=e.__enhanced__;if(!n){"object"==typeof e&&e.$$typeof===Symbol.for("react.forward_ref")&&(t=!0),t?(e.render=j(e.render,!1),n=Object(o.memo)(e)):n=j(e);try{e.__enhanced__=n}catch(e){}}const r=Object.getOwnPropertyNames(e);return r&&r.forEach(t=>{try{n[t]=e[t]}catch(e){console.error(e)}}),n}function j(e,t=!0){function n(t,r){const c=Object(o.useMemo)(()=>{const n={id:Object(s.j)(),version:0,name:e.name,component:e,parent:S.searchNode(t._parent_info_),props:t,responsives:new Set,children:[],subjectAry:[],observerAry:[],implementAry:[]};return S.regNode(n),n},[]);p.current=c,i.a.createElement._cur_parent_info_=c.id,i.a.createElement._render_in_node_info_=c;let f={_from_:"render",hoc:n,nodeInfo:c,update:O(),_curSnap:void 0,getSnap(){if(!this._curSnap){const e=this;this._curSnap={_snap_:!0,version:e.nodeInfo.version,_from_:e._from_,hoc:e.hoc,nodeInfo:e.nodeInfo,update:e.update,getSnap:()=>e._curSnap}}return this._curSnap},updateSnap(){this._curSnap&&(this._curSnap.invalid=!0,this._curSnap=void 0)}};Object(o.useEffect)(()=>()=>{S.cleanUpdater(f),f=void 0},[]),S.setCurUpdater(f);const u=a.current;let l,d;if(u){const e=u.useMemo;if(l=u.useEffect,c){if(e&&!e._rxui_){const n=function(n,r){return e((function(...e){let r;try{r=S.stopWatch(()=>n(...e))}catch(e){w("useMemo",t,e)}return r}),r)};n._rxui_=!0,u.useMemo=n}if(l&&!l._rxui_){const e=function(e,n){return l((function(...n){let r;S.curRT.setNodeInfoId(c.id);try{r=e(...n)}catch(e){w("useEffect",t,e)}finally{S.curRT.clear()}return r}),n)};e._rxui_=!0,u.useEffect=e}}}try{d=e(t,r)}catch(e){d=w("render",t,e)}return null==d&&(d=i.a.createElement(i.a.Fragment)),l&&(u.useEffect=l),Object(o.useLayoutEffect)(()=>{S.setCurUpdater(void 0)}),p.current=void 0,i.a.createElement._render_in_node_info_=c.parent,d}return n.displayName=e.displayName||e.name,t?Object(o.memo)(n):n}function w(e,t,n){if(!t||"function"!=typeof t._onError_&&"function"!=typeof t._onerror_){const r=t._parent_info_;if(r){const t=S.searchNode(r);if(null==t?void 0:t.props)return w(e,t.props,n)}throw n}return(t._onError_||t._onerror_)(n,e)}function O(){const[e,t]=Object(o.useState)(0);return Object(o.useCallback)(e=>{t(e=>e+1)},[])}const E=Object(s.i)("nodes",{});let x,T,P=null;const D=Object(s.i)("IgnoreRx",{stopWatcher:void 0,stopUpdate:void 0});let I=Object(s.i)("curUpdater",{cur:void 0});const A=Object(s.i)("batchStack",[]);var S;function M(e,t){return e&&t&&e.nodeInfo&&t.nodeInfo&&e.nodeInfo.id===t.nodeInfo.id&&e.hoc===t.hoc}!function(e){function t(e){return E[e]}e.curRT={setNodeInfoId(e){x=e},setInfoIdForDelay(){T=x},getNode(){const e=p.current;if(e)return E[e.id];if(x){const e=E[x];if(e)return e}return T?E[T]:void 0},clear(){x=null},clearDelay(){T=null}},e.regNode=function(e){if(E[e.id]=e,P){let n,r=e.parent;if(r){if(r.invalid)return;n=t(r.id),e.parent=n,n.children.push(e)}}else P=e},e.regListener=function(e,n){const r=p.current;if(!r)throw new Error("CurrentNodeInfo.current is undefined.");const o=t(r.id);return n&&o[e+"Ary"].push(n),o},e.getCurNode=function(){const e=p.current;if(!e)throw new Error("CurrentNodeInfo not found.");return t(e.id)},e.searchNode=t,e.setCurUpdater=function(e){I&&(I.cur=e)},e.getCurUpdater=function(){if(I)return I.cur},e.stopWatch=function(e){if("function"==typeof e){D.stopWatcher=!0;try{return e(()=>{D.stopWatcher=void 0})}finally{D.stopWatcher=void 0}}},e.keepWatch=function(e){if("function"==typeof e){const t=D.stopWatcher;D.stopWatcher=void 0;try{return e(()=>{D.stopWatcher=t})}finally{D.stopWatcher=t}}},e.stopUpdate=function(e){if("function"==typeof e){D.stopUpdate=!0;try{return e(()=>{D.stopUpdate=void 0})}finally{D.stopUpdate=void 0}}},e.igonreObservableBefore=function(){I={}},e.cleanUpdater=function(e){try{e.updateSnap(),function e(t,n){var r;null===(r=t.responsives)||void 0===r||r.forEach(e=>{e.forEach((n,r)=>{n.nodeInfo&&!n.nodeInfo.invalid&&n.nodeInfo.id!==t.id||e.splice(r,1)})});const o=E[t.id];if(o){if(o.parent){const e=o.parent.children;e.forEach((n,r)=>{n.id===t.id&&e.splice(r,1)})}o.children&&o.children.forEach(t=>{e(t)}),E[t.id]=null,delete E[t.id]}t.component=null,t.invalid=!0,t.props=null}(e.nodeInfo),e.nodeInfo&&(e.nodeInfo=null),e.hoc=null,e.update=null}catch(e){console.error(e)}},e.applyBatch=function(){const e=[];return A.push(e),{commit(){A.pop(),e.forEach(e=>{e&&e.nodeInfo&&!e.nodeInfo.invalid&&e.update(e)})},cancel(){A.pop()}}};const n=function(){let e,t=[];return{clear(){t=[]},push(n){t.find(e=>M(e,n))||t.push(n.getSnap()),e||(e=1,Promise.resolve().then(()=>{e=void 0,t.forEach((e,n)=>{t[n]=void 0,e&&e.nodeInfo&&!e.nodeInfo.invalid&&(e.invalid?console.log("updater.invalid",e):e.update())}),t=t.filter(e=>e)}))}}}();e.applyAgent=function(){const t={};return{push(n,r){if(D.stopWatcher)return;let o=t[r];o||(o=t[r]=[]);const i=e.getCurUpdater();if(i){let e;i.nodeInfo,i.nodeInfo.responsives.add(o),o.find((t,n)=>{if(M(t,i))return e=n,!0})?e>=0&&(o[e]=i.getSnap()):o.push(i.getSnap())}},update(r,o,i){if(D.stopUpdate)return;const f=r+"="+("function"==typeof i?"function":"object"==typeof i?"{..}":i),u=A[A.length-1];if(u){const e=t[o];e&&e.length>0&&e.forEach(e=>{!e.nodeInfo||e.nodeInfo.invalid||u.find(t=>M(t,e))||(e.watch=`[${e.nodeInfo.id}]${f}`,u.push(e))})}else{let r=t[o];if(r)try{Object(c.unstable_batchedUpdates)(()=>{r.forEach((t,o)=>{if(t&&t.nodeInfo&&!t.nodeInfo.invalid&&!t.invalid){t.watch=`[${t.nodeInfo.id}]${f}`;const r=e.getCurUpdater();if(x&&r&&r===t)return;return r&&r.nodeInfo.id!==t.nodeInfo.id?x&&x===t.nodeInfo.id?t.update(t):n.push(t):t.update(t),t}r.splice(o,1)})}),0===t[o].length&&(t[o]=void 0,delete t[o])}catch(e){console.error(e)}}}}}}(S||(S={}));const R={},C={};var W=n(3),k=n(0);let U,$,N,L;function F(e,t){if("object"!=typeof e)throw new Error("Invalid data format.");le(e)&&(e=ae(e)),e=JSON.parse(JSON.stringify(e));const n=S.applyBatch(),r={};N="_F_",L="_R_";for(let n in e){const o=e[n];if(t){const e=B(o);r[n]=e}else B(o,{merge(e){const t=R[n];void 0!==t?r[n]=K(e,t):C[n]=t=>{const o=S.applyBatch();r[n]=K(e,t),o.cancel()}}})}return n.commit(),r}function B(e,t={}){if("object"!=typeof e||"object"!=typeof e.def||"object"!=typeof e.refs)throw new Error("Invalid data format.");const{merge:n}=t,{def:r,refs:o,D:i,consts:c}=e;if(c)N="_from_",L="_ref_",U={C:c.froms,W:{}};else if(i)if(i.W){const e={};Object.keys(i.W).forEach(t=>{e[i.W[t]]=t}),i.W=e,U=i}else U=Object.assign({W:{}},i);else U={C:{},W:{}};$={refs:o,didMap:{}},Object.keys(o).forEach(e=>{let t,n=o[e];if(void 0!==(t=n[N])){t=U.C[t]||t;const r=W.c[t];if(!r)return;if(!r||!r.proto)throw new Error("Invalid data format.");{const i=V(r.proto);i[N]=t,i._merge_data_=n,o[e]=i}}});const f=r;if(!n)return z(f);n(f)}function K(e,t){const n=z(e,t);return n&&"object"==typeof n&&t?(Object.keys(n).forEach(e=>{let r=n[e];t[e]=r}),t):n}function z(e,t){const{refs:n,didMap:r}=$;if(Array.isArray(e))return e.map(e=>z(e));if("object"==typeof e&&e){if(e[k.a])return r[e[k.a]]=t||e,t||e;const o=e[L];if("string"==typeof o){if(!t&&r[o])return r[o];e=n[o],r[o]=t||e}let i,c;if(c=e[N]){if(i=W.c[c],!i)return;if(!i||!i.proto)throw new Error("Invalid data format.")}delete e[N];let f=e._merge_data_;if(void 0===f&&i&&(f=e,e=V(i.proto)),f){delete e._merge_data_,delete f[N];let t=Object(s.c)(f);if(t.length>0){const n=f[k.c];t.forEach(t=>{let r=U.W[t],o=f[t];if(r?(f[t]=void 0,delete f[t]):r=t,t===k.c)return;const c=Object(s.e)(e,r);if(!(c&&c.get&&!c.set||n&&n[r]||n&&n[r])){const t=z(o);try{let n;if(i&&"function"==typeof(n=i.load)){let o=n(e,r,t);void 0!==o&&(e[r]=o)}else try{e[r]=t}catch(e){throw e}}catch(e){throw e}}})}}else{let t=Object(s.c)(e);if(t.length>0){const n=e[k.c];t.forEach(t=>{let r=U.W[t],o=e[t];if(r?(e[t]=void 0,delete e[t]):r=t,t===k.c)return;const c=Object(s.e)(e,r);if(!(c&&c.get&&!c.set||n&&n[r]||n&&n[r])){n&&console.log(r);const t=z(o);let c;const f=Object(s.e)(e,r);if(f&&f.get&&!f.set)return;if(i&&"function"==typeof(c=i.load)){let n=c(e,r,t);void 0!==n&&(e[r]=n)}else try{e[r]=t}catch(e){throw e}}})}}}return e}function V(e){return new e}function X(e,t={}){const n=(e,t,n)=>n;if("string"==typeof e){if(R[e])return q(R[e],n,Object.assign(t,{noFunction:!0}))}else if(e&&"object"==typeof e)return q(e,n,Object.assign(t,{noFunction:!0}))}function q(e,t,n={}){const{noFunction:r,uncompressed:o,map:i}=n;let c={},f={},u={C:[],W:o?void 0:{}},a=0;let l={},p=0;function d(e){if(o)return e;let t=l[e];return void 0===t&&(l[e]=t=p+++""),t}const _={D:u,refs:c,def:function e(n){if("object"!=typeof n||!n)return n;if(Y(n))return;if(n[k.a]){const e=d(n[k.a]);if(c[e])return{_R_:e};if(f[e])return{_R_:e}}let l={};if(Array.isArray(n)&&(l=[]),n[k.a]&&(f[d(n[k.a])]=!0),Array.isArray(n)){const r=[];Object.keys(n).forEach(o=>{try{if(o.match(/^__.+__$/g)||l[o])return}catch(e){}const i=n[o];Y(i)?(r.push(o),l[o]=void 0):l[o]=e(t(n,o,i))}),r.length>0&&r.forEach(e=>l.splice(e,1))}else{let c=Object(s.c)(n);if(c.length>0){const f=n[k.c];c.forEach(c=>{if(c===k.c||c===k.e||"_from_"===c||"_hc_temp_"===c)return;const p=Object(s.e)(n,c);if((!p||!p.get||p.set)&&(!f||!f[c])){let f=n[c];if(!r||r&&"function"!=typeof f&&!Object(s.g)(f))if("function"==typeof i&&(f=i(n,c,f)),c!==k.a&&"_F_"!==c){const r=function(e){if(o)return e;if(/^[0-9]+$/.test(e))return e;if(/^u_/.test(e))return e;let t=u.W[e];return void 0===t&&(u.W[e]=t="_"+a+++"_"),t}(c);l[r]=e(t(n,c,f))}else l[c]=f}})}!0===n._observable_&&(l._observable_=!0);const f=Object(W.d)(n);let p;if(f&&(p=f.serialized)){u.C.find(e=>e===p.name);let e=u.C.indexOf(p.name);-1===e&&(u.C.push(p.name),e=u.C.length-1),l._F_=e}else if(n[k.a])throw new Error("Invalid data format.")}if(l[k.a]){const e=d(l[k.a]);return c[e]=l,delete l[k.a],{_R_:e}}return l}(e)};return f=void 0,_}function Y(e){return e&&"object"==typeof e&&e[k.d]}function J(e,t,n){var r;if(n&&"function"==typeof n){const e=Object(W.d)(t);if(!(null===(r=null==e?void 0:e.serialized)||void 0===r?void 0:r.name))throw new Error("No @Serializable({name:string}|string) decorator on "+n)}const o=C[e];void 0!==o&&o(t),R[e]=t}function H(e){if(!e[k.a])throw new Error(`Model must has ${k.a} property.`);let t=!1,n={},r=o=>{if("object"==typeof o&&null!==o){if(o[k.a]==e[k.a])return!0;if(n[o[k.a]])return;n[o[k.a]]=!0;Object(s.c)(o).forEach(e=>{const n=Object(s.e)(o,e);if(n&&n.get&&!n.set)return;let i=o[e];Array.isArray(i)?(i=i.map(e=>r(e)?void(t=!0):e),t&&(o[e]=i.filter(e=>void 0!==e))):r(i)&&(t=!0,o[e]=void 0)})}};return Object.keys(R).forEach(e=>{r(R[e])}),n=void 0,t}function G(e,t){if(void 0===e)return e;let n=[];return function e(r){if("object"!=typeof(r=ae(r))||!r)return r;for(let e=0;e<n.length;e++)if(n[e].target===r)return n[e].copyTarget;let o={};if(Array.isArray(r)&&(o=[]),n.push({target:r,copyTarget:o}),Array.isArray(r))Object.keys(r).forEach(t=>{/^__.+__$/g.test(t)||o[t]||(o[t]=e(r[t]))});else if(r instanceof RegExp);else{let n=Object(s.c)(r);if(n.length>0){let i=r[k.c];n.forEach(n=>{if(n!==k.a&&(t||!i||!i[n])){const t=Object(s.e)(r,n);t&&t.get?Object.defineProperty(o,n,{get:()=>e(r[n])}):o[n]=e(r[n])}})}}return o}(e)}function Q(e){"object"==typeof e&&(e[k.d]=!0)}const Z=/^before\@splice$/;let ee;class te{constructor(e){this._undo={states:[],reg:new WeakMap},this._redo={states:[],reg:new WeakMap},this.listener=e}setUndo(e,t,n,r){this.sleeping||this.set(e,t,n,this._undo)&&this.listener&&(void 0!==r&&!0!==r||this.listener(e,t,n))}setRedo(e,t,n,r){this.sleeping||this.set(e,t,n,this._redo)&&this.listener&&(void 0!==r&&!0!==r||this.listener(e,t,n))}sleep(e){this.sleeping=!0;try{"function"==typeof e&&e()}catch(e){throw e}finally{this.sleeping=!1}}dump(){return ee=null,this}undo(){ee=null;const e=S.applyBatch();try{this._undo.states.forEach(({obj:e,prop:t,val:n})=>{let r;r=Array.isArray(e)&&"length"===t?n:ne(t)?e:e[t],this.setRedo(e,t,r,!1),this.setVal(e,t,n)}),e.commit()}catch(t){console.error(t),e.cancel()}}redo(){ee=null;const e=S.applyBatch();try{this._redo.states.forEach(({obj:e,prop:t,val:n})=>{let r;r=ne(t)?n:e[t],this.setUndo(e,t,r,!1),this.setVal(e,t,n)}),e.commit()}catch(t){console.error(t),e.cancel()}}cancel(){ee=null}set(e,t,n,r){let o=r.reg.get(e);if(o||(o={},r.reg.set(e,o)),!(t in o)){if(o[t]=n,Array.isArray(e)&&ne(t)){const n=[];e.forEach(e=>n.push(e)),r.states.push({obj:e,prop:t,val:n})}else r.states.push({obj:e,prop:t,val:n});return!0}}setVal(e,t,n){if(Array.isArray(e)){const r=e;ne(t)?(r.splice(0,e.length),n.forEach(t=>{e.push(t)})):t.match(/^\d+$/)&&void 0===n?e.splice(parseInt(t),1):"length"===t?e.length===n&&(e[t]=n):e[t]=n}else e[t]=n;this.listener&&this.listener(e,t,n)}}function ne(e){return e.match(Z)}class re extends Error{}const oe=new WeakMap,ie=new WeakMap,ce=Object(s.a)(),fe=new WeakMap;function ue(e,t=e,n,r){let o,i,c;"function"==typeof e&&(e=new e),"object"==typeof n&&(n.to||(o=n.expectTo),Array.isArray(n.ignore)&&(i=n.ignore),"function"==typeof n.watch&&(c=n.watch));const f=[];function u(e,t,n,r,o){c&&c(t,r,o);let i=e;do{const{source:e}=i,c=ie.get(e);c&&c.forEach(({on:i,exe:c,node:f,target:u})=>{f.invalid||e!==ae(u)||t.match(new RegExp(`.${i}$`))&&ce.push(c,n,r,o)})}while(i=i.parent)}return function e(n,c,a="",l){if(le(n))return n;if("object"==typeof n&&"_isVue"in n)return n;const p={},d={get(e,t,n){let r;if("function"==typeof t)[e]in p?r=p[e]:p[e]=r=n();else{if(le(t))return t;r=oe.get(t),void 0===r&&oe.set(t,r=n())}return r}};l&&fe.set(n,`${Object(s.d)(c.source)}_${l}`);const _={source:n,proxy:void 0,parent:c},h=S.applyAgent(),y=new Proxy(n,{has:(e,t)=>"__observable__"===t||"__original__"===t||t in e,get(u,l,p){if(u instanceof RegExp)return u[l];if("__observable__"===l)return!0;if("toString"===l||"toJSON"===l||"valueOf"===l||"$$typeof"===l||"constructor"===l||Object(s.h)(l))return u[l];if("__original__"===l)return"__original__"in u?u.__original__:ae(n);if("__isExpectTo__"===l)return o;if("__pushWatch__"===l)return e=>{let t=ie.get(n);t||ie.set(ae(n),t=new Set),t.has(e)||t.add(e)};if("__pushJoinFrom__"===l)return(e,t)=>{t.forEach(([t,n])=>{const r=t.split("."),o=n.split(".");let i,c=e,f=p;r.forEach((e,t)=>{c=c[e],t===r.length-1&&(i="object"==typeof c&&c?G(c):c)}),o.forEach((e,t)=>{if(t===o.length-1)f[e]=i;else if(f=f[e],!f)return!1})})};if("__pushJoinTo__"===l)return(e,t)=>{f.push({to:e,mapping:t})};let y;const g=Object(s.e)(u,l);y=g&&g.get?g.get.call(p):u[l];const b=u[k.e];if(b&&b[l])return y;const m=a+(l.match(/^\d+$/)?`[${l}]`:"."+l);if(void 0!==y||!o||""!==a){if("function"==typeof y){let e;return e=Array.isArray(u)?/^(splice)$/gi.test(l)?d.get(l,y,()=>(...e)=>{var t;if(ee){const n=null===(t=a.match(/\.([^\.]+)$/))||void 0===t?void 0:t[1];let r=c.source[k.c];if(!(r&&r[n])){let t;return ee.setUndo(p,"before@splice",u),ee.sleep(()=>{t=y.call(p,...e)}),t}return y.call(p,...e)}return y.call(p,...e)}):/^(indexOf)$/gi.test(l)?(...e)=>{const t=e.map(e=>ae(e)),n=u.map(e=>ae(e));return y.call(n,...t)}:y:d.get(l,y,()=>(...e)=>{try{if(u instanceof Date||u instanceof Set||u instanceof Map)return u[l].call(u,...e);try{return u[l].call(p,...e)}catch(t){if(t instanceof TypeError)return u[l](...e);throw t}}catch(e){throw e}}),e}return h.push(m,l),i&&-1!==i.indexOf(l)?y:"object"==typeof y&&y&&!(Object(s.g)(y)||y instanceof RegExp||y.$$typeof||y.nodeType&&y._id)?d.get(l,y,()=>{let t;return se(u)&&!Object(s.f)(u,l)&&(t=l),e(y,_,m,t)}):y}if(h.push(m,l),r){const e=function(e,t,n){if("parents"===n.direction){let r,o=n.node.parent;for(;o&&(!o.implementAry||!o.implementAry.find(n=>{if(n.type===e&&"children"===n.direction){try{r=n.proxy[t]}catch(e){if(!(e instanceof re))throw e}if(void 0!==r)return!0}}));)o=o.parent;if("function"==typeof r)return r}else if("children"===n.direction){const r=[],o=n=>{n&&n.length>0&&n.forEach(n=>{n.implementAry&&n.implementAry.find(n=>{if(n.type===e){let e;try{e=n.proxy[t]}catch(e){if(!(e instanceof re))throw e}if(void 0!==e)return r.push(e),!0}})||o(n.children)})},i=n.node.children;if(o(i),r.length>0)return r}}(t,l,r());return Array.isArray(e)?(...t)=>{let n=[];return e.forEach(e=>{n.push(e(...t))}),1==n.length?n[0]:n}:e}},set(e,t,n,r){var o;if("__proto__"===t)return e[t]=n,!0;const i=e[t];if(i!==n||Array.isArray(e)&&t&&"length"===t){const c=a+"."+t;if(ee&&se(e)&&!Object(s.g)(i)){const n=e[k.c];!(n&&n[t])&&ee.setUndo(r,t,i)}const l=Object(s.e)(e,t);if(l&&l.set?l.set.call(r,n):e[t]=n,u(_,c,t,n,i),h.update(c,t,n),f.length>0&&f.find(({to:e,mapping:t})=>{if(!t.find(([t,r])=>{if("."+t===c){const t=r.split(".");let o=e;return t.forEach((e,r)=>{const i=t[r];r===t.length-1?o[i]=n:o=o[i]}),!0}})){const t=c.replace(/^\./,"").split(".");let r=e;t.forEach((e,o)=>{if("object"!=typeof r||!r)return!1;{const e=t[o];o===t.length-1?r[e]=n:r=r[e]}})}}),Array.isArray(e)&&t.match(/^(\d+)|length$/)){const t=null===(o=a.match(/\.([^\.]+)$/))||void 0===o?void 0:o[1];u(_,a,t,e,e)}}return!0}});return _.proxy=y,y}(e,void 0,void 0,!1)}function se(e){return k.a in e||fe.has(e)}function ae(e){return"object"==typeof e&&e&&e.__original__||e}function le(e){return"object"==typeof e&&e&&["__observable__"]in e}function pe(e){le(e.target)&&e.target.__pushWatch__(e)}function de(e,t,n,r,i){const c=[...arguments];n=c.find(e=>"object"==typeof e?e:void 0);const f=Object(o.useRef)(null);let u=!f.current;if(u){if(arguments.length<1)throw new Error("invalid arguments,expect <T>(class:new ()=>T|T).");if("object"!=typeof e&&"function"!=typeof e||!e)throw new Error("invalid arguments,expect <T>(class:new ()=>T|T).");let r;r="function"==typeof e?new e:e;let o=null;const i=ue(r,e,n,()=>o);if("function"==typeof t&&S.stopWatch(e=>{t(t=>{if(e(),t&&"object"==typeof t)return _e(t,i),!0})}),"object"==typeof n){if(n.to){const t=he(e,i,n.to);t&&(o=t)}else if(n.expectTo){const t=he(e,i,n.expectTo);t&&(o=t)}"function"==typeof n.init&&n.init(ae(i))}he(e,i,"self");const u=c.find(e=>"string"==typeof e?e:void 0);u&&J(u,i,e),f.current=i}i=c.find(e=>Array.isArray(e))||[];const s=[...i],a=Object(o.useCallback)(()=>{if(i&&!u){const r=f.current;if("function"!=typeof e)for(let t in e){const n=e[t];r[t]=n}else"function"==typeof t&&S.stopWatch(e=>{t(t=>{if(e(),t&&"object"==typeof t){for(let e in t)r[e]=t[e];return!0}})});"function"==typeof(null==n?void 0:n.init)&&n.init(ae(r))}},s);return Object(o.useMemo)(a,s),f.current}function _e(e,t){const n=Object.getOwnPropertyNames(e);n&&n.forEach(n=>{const r=e[n];"function"==typeof r?"constructor"!==n&&(t[n]=r):t[n]=r});const r=Object.getPrototypeOf(e);r&&r!==Object.prototype&&_e(r,t)}function he(e,t,n){if("string"!=typeof n||!/^(children|parents|self)$/gi.test(n))throw new Error("direction = 'children'|'parents' expect.");const r=new Proxy({},{has:(e,t)=>"__observable_proxy__"===t||t in e,get:(e,n)=>t[n],set:(e,n,r)=>(t[n]=r,!0)}),o=S.regListener("subject",{type:e,direction:n,proxy:r});if(o&&"self"!==n)return{direction:n,node:o}}function ye(e){const[,t]=Object(o.useState)(),n=S.getCurUpdater(),r=Object(o.useMemo)(()=>({c:0,fn:e,updater:{_from_:"useComputed",hoc:e,nodeInfo:p.current,update:function(){t(r.c++)},_curSnap:void 0,getSnap(){if(!this._curSnap){const e=this;this._curSnap={version:e.nodeInfo.version,_snap_:!0,_from_:e._from_,hoc:e.hoc,nodeInfo:e.nodeInfo,update:e.update,getSnap:()=>e._curSnap}}return this._curSnap},updateSnap(){this._curSnap}}}),[]),i=Object(o.useMemo)(()=>{const t=r.updater;let o;S.setCurUpdater(t),t.updateSnap();try{o=S.keepWatch(e)}catch(e){if(!t.nodeInfo||!t.nodeInfo.props)throw e;!function e(t,n,r){if(ge.has(r))return console.error(r),void setTimeout(e=>ge.delete(r));ge.set(r,!0);if(!n||"function"!=typeof n._onError_&&"function"!=typeof n._onerror_){const o=n._parent_info_;if(o){const n=S.searchNode(o);if(null==n?void 0:n.props)return e(t,n.props,r)}throw r}return(n._onError_||n._onerror_)(r,t)}("render",t.nodeInfo.props,e)}finally{S.setCurUpdater(n)}return o},[r.c]);return Object(o.useEffect)(()=>()=>{S.cleanUpdater(r.updater)},[]),i}const ge=new WeakMap;function be(e,t,n){Object(o.useMemo)(()=>{const r="useWatcher(target:Observable,on:string,callback:(prop: string, value: any, preValue?: any) => void).";if(!le(e))return;if("string"!=typeof t)throw new Error(r);if("function"!=typeof n)throw new Error(r);const o=S.regListener("observer");pe({target:e,on:t,exe:n,node:o})},[])}function me(e,t){const n=Object(o.useRef)();return Object(o.useMemo)(()=>(n.current||(n.current=e()),n.current),t)}function ve(e,t,n,r){const i=[...arguments];let c;if(n=i.find(e=>"object"==typeof e),r=i.find(e=>Array.isArray(e)),n&&n.from)c=Object(o.useRef)();else if(c={},r)throw new Error("Updater can not be used here.");let f=!c.current;if(void 0===c||!c.current){if(arguments.length<0)throw new Error("invalid arguments,expect <T>(class:new ()=>T).");if("function"!=typeof e||!e)throw new Error("invalid arguments,expect <T>(class:new ()=>T).");const r={watcherPushed:{}};let o;if("function"==typeof t){const e=t(e=>{if(e&&"object"==typeof e)return r.implVal=e,!0});"object"==typeof e&&(r.implVal=e)}const i=new Proxy({},{has(e,t){return this.get(e,t)},get(t,i){if("toString"===i||"valueOf"===i||"$$typeof"===i||"constructor"===i||i===Symbol.toPrimitive||i===Symbol.toStringTag||i===Symbol.iterator)return t[i];if(r.implVal){let e=r.implVal[i];if(void 0!==e)return e}if(null==n?void 0:n.from){const t=je("subject",e,null==n?void 0:n.from,o,i);let c;if(!r.watcherPushed[i]&&le(t)&&"object"==typeof n.watch&&(c=n.watch)){r.watcherPushed[i]=!0;const e=new RegExp(`^${i}.(.+)$`);c.on.match(e)&&pe({target:t,on:c.on.replace(e,"$1"),exe:c.exe,node:o})}return t}{const t=S.curRT.getNode();if(t&&t.subjectAry){let n;return t.subjectAry.find(t=>{if("self"===t.direction&&t.type===e)return n=t.proxy[i],!0}),n}}},set(t,r,i){let c=o,f=null==n?void 0:n.from;return f||(f="self",c=S.curRT.getNode()),c&&we("subject",e,f,c,r,i),!0}});n&&n.from&&(o=S.regListener("observer",{type:e,direction:n.from,proxy:i}),S.regListener("subject",{type:e,direction:"self",proxy:i})),r.proxy=i,c.current=r}if(r){const e=[...r],n=Object(o.useCallback)(()=>{if(r&&!f){const e=c.current.implVal;"function"==typeof t&&t(t=>{if(t&&"object"==typeof t){for(let n in t)e[n]=t[n];return!0}})}},e);Object(o.useEffect)(n,e)}return c.current.proxy}function je(e,t,n,r,o){if(e+="Ary","parents"===n){let i,c=r.parent;for(;c&&("TableContent"===t.name&&console.log(c),!c[e]||!c[e].find(e=>{if(e.direction!==n&&"self"!==e.direction&&e.type===t)return i=e.proxy,!0}));)c=c.parent;if(void 0!==i)return i[o]}else if("children"===n){const i=[],c=r=>{r&&r.length>0&&r.forEach(r=>{r[e]&&r[e].find(e=>{if(e.direction!==n&&"self"!==e.direction&&e.type===t){let t;try{t=e.proxy[o]}catch(e){if(!(e instanceof re))throw e}if(void 0!==t)return i.push(t),!0}})||c(r.children)})},f=r.children;if(c(f),i.length>0)return i;throw new Error(`No implements found for(${o})`)}}function we(e,t,n,r,o,i){if(e+="Ary","parents"===n){let n=r.parent;for(;n&&(!n[e]||!n[e].find(e=>{if(e.type===t)return e.proxy[o]=i}));)n=n.parent}else if("children"===n){const n=r=>{r&&r.length>0&&r.forEach(r=>{r[e]&&r[e].find(e=>{if(e.type===t)return e.proxy[o]=i,!0})||n(r.children)})},c=r.children;n(c)}else"self"===n&&r.subjectAry&&r.subjectAry.find(e=>{if("self"===e.direction&&e.type===t)return e.proxy[o]=i,!0})}function Oe(e,t,n,r){const i=[...arguments];if(!(n=i.find(e=>"object"==typeof e))||"object"!=typeof n||!n.from)throw new Error("invalid argument config,expect pipe(typeClass, impl, config: {from:'parents'|'children'}).");let c;r=i.find(e=>Array.isArray(e)),c=n&&(n.from||(null==n?void 0:n.expectTo))?Object(o.useRef)():{};let f=!c.current;if(void 0===c||!c.current){if(arguments.length<0)throw new Error("invalid arguments,expect <T>(class:new ()=>T).");if("function"!=typeof e||!e)throw new Error("invalid arguments,expect <T>(class:new ()=>T).");const r={watcherPushed:{}};let o;if("function"==typeof t){const e=t(e=>{if(e&&"object"==typeof e)return r.implVal=e,!0});"object"==typeof e&&(r.implVal=e)}function u(t,r){let i;try{i=Ee("implement",e,n.expectTo,o,t)}catch(e){i=[]}if(!Array.isArray(i)){if("function"!=typeof i)throw new Error("ExpectTo's value must be a Function type.");i=[i]}return r&&i.push(r),i.length>0?(...e)=>{let t=[];return i.forEach(n=>{t.push(n(...e))}),1==t.length?t[0]:t}:()=>{}}const i=new Proxy({},{get(e,t){if("toString"===t||"valueOf"===t||"$$typeof"===t||"constructor"===t||t===Symbol.toPrimitive||t===Symbol.toStringTag||t===Symbol.iterator)return e[t];if(r.implVal){let e=r.implVal[t];if(void 0!==e){if(null==n?void 0:n.expectTo){if("function"!=typeof e)throw new Error("ExpectTo's value must be a Function type.");return u(t,e)}return e}}return(null==n?void 0:n.expectTo)?u(t):void 0},set:(t,r,i)=>(xe("subject",e,n.from,o,r,i),!0)});o=S.regListener("implement",{type:e,direction:n.from,proxy:i}),r.proxy=i,c.current=r}if(r){const e=[...r],n=Object(o.useCallback)(()=>{if(r&&!f){const e=c.current.implVal;"function"==typeof t&&t(t=>{if(t&&"object"==typeof t){for(let n in t)e[n]=t[n];return!0}})}},e);Object(o.useEffect)(n,e)}return c.current.proxy}function Ee(e,t,n,r,o){if(e+="Ary","parents"===n){let i,c=r.parent;for(;c&&(!c[e]||!c[e].find(e=>{if(e.direction!==n&&"self"!==e.direction&&e.type===t)return i=e.proxy,!0}));)c=c.parent;if(void 0!==i)return i[o]}else if("children"===n){const i=[],c=r=>{r&&r.length>0&&r.forEach(r=>{r[e]&&r[e].find(e=>{if(e.direction!==n&&"self"!==e.direction&&e.type===t){let t;try{t=e.proxy[o]}catch(e){if(!(e instanceof re))throw e}if(void 0!==t)return i.push(t),!0}})||c(r.children)})},f=r.children;if(c(f),i.length>0)return i;throw new Error(`No implements found for(${o})`)}}function xe(e,t,n,r,o,i){if(e+="Ary","parents"===n){let n=r.parent;for(;n&&(!n[e]||!n[e].find(e=>{if(e.type===t)return e.proxy[o]=i}));)n=n.parent}else if("children"===n){const n=r=>{r&&r.length>0&&r.forEach(r=>{r[e]&&r[e].find(e=>{if(e.type===t)return e.proxy[o]=i,!0})||n(r.children)})},c=r.children;n(c)}else"self"===n&&r.subjectAry&&r.subjectAry.find(e=>{if("self"===e.direction&&e.type===t)return e.proxy[o]=i,!0})}function Te(e,t){if(!le(e))throw new Error("The join to object must be an observable object.");if(le(n=e)&&n.__isExpectTo__)throw new Error("The observable object has expectTo,join is not allowed.");var n;return{joinTo(n,r){if("object"==typeof n){if(!le(n))throw new Error("The join from object must be an observable object.");if((null==t?void 0:t.length)!==(null==r?void 0:r.length))throw new Error("The mapping props(in from and to) must be a same length.");let o=[];if((null==t?void 0:t.length)>0)null==t||t.forEach((e,t)=>{o.push([e,r[t]])});else{Object(s.c)(e).forEach(e=>{o.push([e,e])})}!function(e,t,n){e.__pushJoinTo__(t,n)}(e,n,o),function(e,t,n){e.__pushJoinFrom__(t,n)}(n,e,o)}}}}function Pe(e){if(!le(e))throw new Error("The join to object must be an observable object.");const t=ue({});return new Proxy(t,{has:(n,r)=>r in t||r in e,get(n,r,o){const i=t[r];return r in t?i:e[r]},set:(e,n,r,o)=>(t[n]=r,!0),ownKeys:t=>Reflect.ownKeys(e),getOwnPropertyDescriptor:(t,n)=>Reflect.getOwnPropertyDescriptor(e,n)})}function De(e,t){let n=Object.getOwnPropertyDescriptor(e,k.e);if(n)n.value[t]=!0;else{let n,r=Object.getPrototypeOf(e);for(;r&&r!==Object.prototype&&(n=Object.getOwnPropertyDescriptor(r,k.e),!n);)r=Object.getPrototypeOf(r);const o=Object.assign({},n&&n.value);Object.defineProperty(e,k.e,{value:o,writable:!0}),o[t]=!0}}let Ie;const Ae={push(e){Se.push(e),this.handler.size+=1},handler:ue({name:"Undo",size:(Se=[{}]).length,exe(){if(Se.length<=1)return;const e=Se.pop();e.undo(),Ae.handler.size-=1,Me.push(e)}})};var Se;const Me=(e=>({push(t){e.push(t),this.handler.size+=1},handler:ue({name:"Redo",size:e.length,exe(){if(e.length<=1)return;const t=e.pop();t.redo(),Me.handler.size-=1,Ae.push(t)}})}))([{}]),Re=Ae.handler,Ce=Me.handler;let We;function ke(e){setTimeout(e=>{if(We){const e=We.until-((new Date).getTime()-We.from);e<=0?(Ae.push(We.dump),We=void 0):ke(e)}},e)}function Ue(e,t){if(We)if(Ie!==e)Ae.push(We.dump),We=void 0,Ie=void 0;else{if(!(We.until>0&&(new Date).getTime()-We.from>We.until))return{on(e){},wait(){},commit(e){if(We.until<0)e&&e.wait?(We.from=(new Date).getTime(),ke(We.until)):(Ae.push(We.dump),We=void 0);else{let t=We.until-((new Date).getTime()-We.from);if(t<=0)return Ae.push(We.dump),void(We=void 0);e&&e.wait&&(We.from=(new Date).getTime(),t=We.until),ke(t)}},cancel(){Ie=void 0,n.undo()}};Ae.push(We.dump),We=void 0}Ie=e;let n=function(e){return ee=new te(e),ee}(t);return{on(e){},wait(){if(!We){const e=n.dump();We={from:(new Date).getTime(),until:-1,dump:e}}},commit(e){const t=n.dump();e&&e.wait?We={from:(new Date).getTime(),until:e.wait,dump:t}:(Ie=void 0,Ae.push(t))},cancel(){Ie=void 0,n.undo()}}}const $e=function(e,t,n){return e.evt instanceof MouseEvent?Le(...arguments):Ne(...arguments)};function Ne(e,t,n){const r=(null==n?void 0:n.document)||document,o=e.currentTarget,i=o.offsetWidth,c=o.offsetHeight,f=3==arguments.length&&n&&n.relDom,u=(3==arguments.length&&n&&n.zoom,Fe(o,f)),s=f?Fe(f):{x:0,y:0};let a,l,p,d,_,h=e.pageX-u.x,y=e.pageY-u.y;if(!t)return u;{S.curRT.setInfoIdForDelay();const e=e=>{const n=e.pageX-h,r=e.pageY-y,f=n-a,g=r-l;a=e.pageX-h,l=e.pageY-y,p=e.pageX-s.x,d=e.pageY-s.y,"finish"===_?t({po:{x:a,y:l},epo:{ex:p,ey:d},dpo:{dx:0,dy:0},adpo:{adx:n,ady:r},targetStyle:{x:u.x,y:u.y,w:i,h:c}},_,o):0==f&&0==g||(_=_?"moving":"start",t({po:{x:a,y:l},epo:{ex:p,ey:d},dpo:{dx:f,dy:g},adpo:{adx:n,ady:r},targetStyle:{x:u.x,y:u.y,w:i,h:c}},_,o))};let n=!1;r.onmousemove=t=>{n||(n=!0,$e.event=t);try{e(t)}catch(e){console.error(e)}},r.onmouseup=t=>{setTimeout(()=>$e.event=void 0);try{const n=S.applyBatch();_&&(_="finish",e(t)),n.commit()}catch(e){throw e}finally{r.onmousemove=null,r.onmouseup=null,S.curRT.clearDelay()}}}}function Le(e,t,n){const r=e.currentTarget,o=r.getStage(),i=Be(r),c={x:i.x,y:i.y,w:r.width(),h:r.height()};let f,u,s,a,l,p=(e=e.evt).pageX-c.x,d=e.pageY-c.y,_=0,h=0;if(!t)return c;{S.curRT.setInfoIdForDelay();const e=(e,n)=>{const o=e.pageX-p-f||0,i=e.pageY-d-u||0;f=e.pageX-p,u=e.pageY-d,s=e.pageX-_,a=e.pageY-h,(n||0!=o||0!=i)&&(l=n?"finish":l?"moving":"start",t({po:{x:f,y:u},epo:{ex:s,ey:a},dpo:{dx:o,dy:i},targetStyle:c},l,r))};let n=!1;o.on("mousemove",t=>{n||(n=!0,$e.event=t);try{e(t.evt)}catch(e){console.error(e)}});const i=t=>{setTimeout(()=>$e.event=void 0);try{const n=S.applyBatch();l&&e(t.evt||t,"finish"),n.commit()}catch(e){throw e}finally{o.off("mousemove"),o.off("mouseup"),S.curRT.clearDelay()}};o.on("mouseup",i)}}function Fe(e,t){if(t){let n=e.getBoundingClientRect(),r=t.getBoundingClientRect();return{x:n.left-r.left,y:n.top-r.top,w:e.offsetWidth,h:e.offsetHeight}}{let t=e.getBoundingClientRect();return{x:t.left,y:t.top,w:e.offsetWidth,h:e.offsetHeight}}}function Be(e,t){if(t){const n=e.getAbsolutePosition(),r=t.getAbsolutePosition();return{x:n.x-r.x,y:n.y-r.y,w:e.width(),h:e.height()}}{const t=e.getAbsolutePosition(),n=e.getStage();if(n&&n.content instanceof k.g){const r=n.content.getBoundingClientRect();return{x:t.x+r.left,y:t.y+r.top,w:e.width(),h:e.height()}}}}function Ke(e){function t(t){e&&e(t)}return t.stop=function(e){var n;"function"==typeof e.stopPropagation?e.stopPropagation():"function"==typeof(null===(n=e.evt)||void 0===n?void 0:n.stopPropagation)&&(e.evt.stopPropagation(),e.cancelBubble=!0),t(e)},t.prevent=function(e){var n;"function"==typeof e.preventDefault?e.preventDefault():"function"==typeof(null===(n=e.evt)||void 0===n?void 0:n.preventDefault)&&e.evt.preventDefault(),t(e)},t.stop.prevent=function(e){var n;"function"==typeof e.preventDefault?e.preventDefault():"function"==typeof(null===(n=e.evt)||void 0===n?void 0:n.preventDefault)&&e.evt.preventDefault(),t.stop(e)},t}console.log(`%c ${r.name} %c@${r.version}`,"color:#FFF;background:#fa6400","","");const ze=S.stopWatch,Ve=S.keepWatch,Xe=S.stopUpdate}])}));